<!DOCTYPE html>
<html>
    <head>
        <link href="../static/fontawesome-free-5.10.2-web/css/all.css" rel="stylesheet">
        <link href="../static/css/template.css" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro&display=swap" rel="stylesheet">
        <link rel="icon" type="image/ico" href="../static/images/EYE.jpg" >
        <p style="text-align:center;"><img src="../static/images/titanfrontend.jpg" alt="Logo" ></p>
        <title>Eye Titan Report</title>
        <h1>Report</h1>

    <script>
    
    fetch('http://localhost:5000/getdata')
      .then(
        function(response) {
          if (response.status !== 200) {
            console.log('Looks like there was a problem. Status Code: ' +
              response.status);
            return;
          }
          // Examine the text in the response
          response.json().then(function(data) {
            let report = JSON.parse(data);
            console.log(report)
            var dataAppend = "<tr>";
            var details = document.getElementById('details')

            Object.size = function(obj) {
                var size = 0, key;
                for (key in obj) {
                    if (obj.hasOwnProperty(key)) size++;
                }
                return size;
            };

            // Get the size of an object
            var size = Object.size(report.face);
            console.log(size)

            //  Remove hardcoded length, 
            //  Need to conver json object to array, or
            //  nest the object inside the array

            for(let i = 0; i < size; i++){

              console.log(new Date(report.end_time[i]));
              dataAppend +=  "<td>" + "<i class='fas fa-user'></i>"+ "</td>" + "<td>" + report.duration[i] + "</td>" +  "<td>" + report.start_time[i] + "</td>" +  "<td>" + report.cam_id[i] + "</td>" +"</tr>" + "<tr>"
              // dataAppend +=  "<td>" + "<i class='fas fa-user'></i>"+ "</td>" + "<td>" + report.cam_id[i] + "</td>" +  "<td>" + report.start_time[i] + "</td>" + "<td>" + report.end_time[i] + "</td>" +"</tr>" + "<tr>"  
            }
            details.innerHTML = dataAppend;
            console.log(dataAppend)
          });
        }
      )
      .catch(function(err) {
        console.log('Fetch Error :-S', err);
      });

    </script>
    </head>
    <body>
        <!-- <p>This is an example of a simple HTML page which will be converted to report page.</p> -->

        <div id="container">
            <table id="faces">
                <thead>
                    <tr>
                        <th> Face </th>
                        <th> Duration </th>
                        <th> Timestamp </th>
                        <!-- <th> End Time </th> -->
                        <th> Cam ID </th>
                    </tr>
                </theaad>
                <tbody id="details">
                </tbody>
            </table>
        </div>

        
    </body>
</html>